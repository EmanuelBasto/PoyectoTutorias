<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Formato de Duración</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .form-group {
            margin: 15px 0;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
        }
        .duration-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .duration-example {
            padding: 10px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            text-align: center;
        }
        .duration-example .minutes {
            font-size: 14px;
            color: #6c757d;
        }
        .duration-example .formatted {
            font-size: 18px;
            font-weight: bold;
            color: #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Prueba de Formato de Duración</h1>
        
        <div class="test-section">
            <h3>Calculadora de Duración</h3>
            <div class="form-group">
                <label for="startTime">Hora de Inicio:</label>
                <input type="time" id="startTime" value="06:00">
            </div>
            <div class="form-group">
                <label for="endTime">Hora de Fin:</label>
                <input type="time" id="endTime" value="10:00">
            </div>
            <div class="form-group">
                <label for="durationResult">Duración Calculada:</label>
                <input type="text" id="durationResult" readonly placeholder="Se calculará automáticamente">
            </div>
        </div>
        
        <div class="test-section">
            <h3>Ejemplos de Formato</h3>
            <div class="duration-examples" id="durationExamples">
                <!-- Se cargarán dinámicamente -->
            </div>
        </div>
        
        <div class="test-section">
            <h3>Pruebas Automáticas</h3>
            <div id="testResults">
                <!-- Resultados de pruebas -->
            </div>
        </div>
    </div>

    <script>
        // FUNCIONES IGUAL QUE EN TUTORES.JS
        function calculateDuration(startTime, endTime) {
            if (!startTime || !endTime) return 0;
            
            // Convertir horas a minutos para facilitar el cálculo
            const startMinutes = timeToMinutes(startTime);
            const endMinutes = timeToMinutes(endTime);
            
            // Calcular la diferencia
            let duration = endMinutes - startMinutes;
            
            // Si la duración es negativa (por ejemplo, de 23:00 a 01:00), asumir que es al día siguiente
            if (duration < 0) {
                duration += 24 * 60; // Agregar 24 horas en minutos
            }
            
            return duration;
        }

        function timeToMinutes(timeString) {
            const [hours, minutes] = timeString.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function formatDuration(minutes) {
            if (!minutes || minutes <= 0) return '';
            
            const hours = Math.floor(minutes / 60);
            const remainingMinutes = minutes % 60;
            
            if (hours === 0) {
                return `${remainingMinutes}min`;
            } else if (remainingMinutes === 0) {
                return `${hours}hr`;
            } else {
                return `${hours}hr ${remainingMinutes}min`;
            }
        }

        function updateDurationField() {
            const startTime = document.getElementById('startTime');
            const endTime = document.getElementById('endTime');
            const durationField = document.getElementById('durationResult');
            
            if (startTime && endTime && durationField) {
                const duration = calculateDuration(startTime.value, endTime.value);
                
                if (duration > 0) {
                    durationField.value = formatDuration(duration);
                } else {
                    durationField.value = '';
                }
            }
        }

        function generateDurationExamples() {
            const examples = [
                { minutes: 30, description: "30 minutos" },
                { minutes: 45, description: "45 minutos" },
                { minutes: 60, description: "1 hora exacta" },
                { minutes: 68, description: "1 hora 8 minutos" },
                { minutes: 90, description: "1 hora 30 minutos" },
                { minutes: 120, description: "2 horas exactas" },
                { minutes: 125, description: "2 horas 5 minutos" },
                { minutes: 180, description: "3 horas exactas" },
                { minutes: 240, description: "4 horas exactas" },
                { minutes: 245, description: "4 horas 5 minutos" }
            ];
            
            const container = document.getElementById('durationExamples');
            container.innerHTML = examples.map(example => `
                <div class="duration-example">
                    <div class="minutes">${example.description}</div>
                    <div class="formatted">${formatDuration(example.minutes)}</div>
                </div>
            `).join('');
        }

        function runTests() {
            const testCases = [
                { start: '06:00', end: '10:00', expected: '4hr' },
                { start: '09:00', end: '10:30', expected: '1hr 30min' },
                { start: '14:00', end: '15:08', expected: '1hr 8min' },
                { start: '08:30', end: '09:15', expected: '45min' },
                { start: '10:00', end: '12:00', expected: '2hr' },
                { start: '13:45', end: '15:20', expected: '1hr 35min' },
                { start: '23:00', end: '01:00', expected: '2hr' },
                { start: '22:30', end: '00:15', expected: '1hr 45min' }
            ];
            
            const resultsContainer = document.getElementById('testResults');
            resultsContainer.innerHTML = '';
            
            testCases.forEach((testCase, index) => {
                const calculated = calculateDuration(testCase.start, testCase.end);
                const formatted = formatDuration(calculated);
                const passed = formatted === testCase.expected;
                
                const resultDiv = document.createElement('div');
                resultDiv.className = 'test-result';
                resultDiv.innerHTML = `
                    <strong>Prueba ${index + 1}:</strong> ${testCase.start} - ${testCase.end}<br>
                    <strong>Esperado:</strong> ${testCase.expected}<br>
                    <strong>Obtenido:</strong> ${formatted}<br>
                    <strong>Resultado:</strong> ${passed ? '✅ PASÓ' : '❌ FALLÓ'}
                `;
                resultDiv.style.backgroundColor = passed ? '#d4edda' : '#f8d7da';
                resultDiv.style.borderColor = passed ? '#c3e6cb' : '#f5c6cb';
                resultDiv.style.color = passed ? '#155724' : '#721c24';
                
                resultsContainer.appendChild(resultDiv);
            });
        }

        // Event listeners
        document.getElementById('startTime').addEventListener('change', updateDurationField);
        document.getElementById('startTime').addEventListener('input', updateDurationField);
        document.getElementById('endTime').addEventListener('change', updateDurationField);
        document.getElementById('endTime').addEventListener('input', updateDurationField);

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            generateDurationExamples();
            runTests();
            updateDurationField();
        });
    </script>
</body>
</html>
